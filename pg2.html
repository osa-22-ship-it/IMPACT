<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IMPACT - UI & DIALOG</title>
  <link rel="stylesheet" href="pg2.css">
</head>
<body>
  <div class="min-h-screen bg-background">
    <!-- Hero Section -->
 <header class="relative overflow-hidden border-b-4 border-primary">
      <div class="absolute inset-0 scanline opacity-20 pointer-events-none"></div>
      <div class="relative z-10 max-w-7xl mx-auto px-8 py-20">
        <div class="flex items-center gap-4 mb-4">
          <svg class="w-12 h-12 text-primary" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="6" y1="11" x2="10" y2="11"></line>
            <line x1="8" y1="9" x2="8" y2="13"></line>
            <line x1="15" y1="12" x2="15.01" y2="12"></line>
            <line x1="18" y1="10" x2="18.01" y2="10"></line>
            <path d="M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z"></path>
          </svg>
          <div class="h-12 w-1 bg-primary"></div>
          <span class="text-muted-foreground uppercase tracking-wider">Type Specimen</span>
        </div>
        <h1 class="text-6xl font-black mb-6 text-foreground leading-tight">
          ST<span class="text-primary">ART</span>
        </h1>
        <p class="text-xl text-muted-foreground max-w-2xl leading-relaxed">
          A showcase of typography in gaming interfaces and memes. Explore UI elements designed for maximum readability and impact.
        </p>
      </div>
    </header>

    <!-- Navigation -->
    <nav class="bg-foreground border-b-2 border-primary sticky top-0 z-50">
      <div class="max-w-7xl mx-auto px-8">
        <div class="flex gap-2 py-4">
          <a href="pg1.html" class="nav-link px-6 py-3 text-muted font-bold uppercase tracking-wide transition-colors">
            01 / Typography Basics
          </a>
          <a href="pg2.html" class="nav-link active px-6 py-3 text-primary-foreground font-bold uppercase tracking-wide transition-colors">
            02 / UI & Dialog
          </a>
          <a href="pg3.html" class="nav-link px-6 py-3 text-muted font-bold uppercase tracking-wide transition-colors">
            03 / Character Set
          </a>
        </div>
      </div>
    </nav>

    <!-- UI Elements -->
    <section class="max-w-7xl mx-auto px-8 py-16">
      <div class="mb-12">
        <h2 class="text-primary mb-2">UI Elements</h2>
        <p class="text-muted-foreground">Buttons, badges, and interactive components</p>
      </div>

      <div class="grid md-grid-cols-2 gap-8">
        <div class="p-8 rounded-lg border-2 bg-card border-border">
          <div class="mb-6">
            <h3 class="mb-2 text-foreground">Button Text</h3>
            <p class="text-muted-foreground">CLICK BUTTONS TO SIMULATE</p>
          </div>
          <div class="button-section">
            <button class="btn-start-game px-8 py-4 bg-primary text-primary-foreground font-black text-xl uppercase tracking-wide hover-bg-primary-90 transition-colors">
              START GAME
            </button>
            <button class="btn-continue px-8 py-4 bg-foreground text-background font-black text-xl uppercase tracking-wide hover-bg-foreground-90 transition-colors">
              CONTINUE
            </button>
            <div class="button-row">
              <button class="btn-settings px-8 py-4 border-2 border-primary text-primary font-bold text-xl uppercase tracking-wide hover-bg-primary hover-text-primary-foreground transition-colors">
                SETTINGS
              </button>
              <button id="quitButton" class="btn-quit px-8 py-4 border-2 border-primary text-primary font-bold text-xl uppercase tracking-wide hover-bg-primary hover-text-primary-foreground transition-colors">
                QUIT?
              </button>
            </div>
          </div>
        </div>

        <div class="p-8 rounded-lg border-2 bg-card border-border">
          <div class="mb-6">
            <h3 class="mb-2 text-foreground">Badges & Labels</h3>
            <p class="text-muted-foreground">Status indicators and tags</p>
          </div>
          <div class="flex flex-wrap gap-3">
            <span class="px-4 py-2 bg-primary text-primary-foreground text-sm font-bold uppercase tracking-wide">New</span>
            <span class="px-4 py-2 bg-foreground text-background text-sm font-bold uppercase tracking-wide">Featured</span>
            <span class="px-4 py-2 bg-secondary text-secondary-foreground text-sm font-bold uppercase tracking-wide">Locked</span>
            <span class="px-4 py-2 border-2 border-primary text-primary text-sm font-bold uppercase tracking-wide">Premium</span>
            <span class="px-4 py-2 bg-muted text-foreground text-sm font-medium uppercase tracking-wide">Common</span>
            <span class="px-4 py-2 bg-primary-10 text-primary text-sm font-bold uppercase tracking-wide border-2 border-primary">Legendary</span>
          </div>
        </div>

        <div class="p-8 rounded-lg border-2 bg-foreground border-background specimen-dark">
          <div class="mb-6">
            <h3 class="mb-2 text-background">Numerical Data</h3>
            <p class="text-muted">Scores, stats, and values</p>
          </div>
          <div class="text-background">
            <div class="space-y-6">
              <div class="flex items-baseline gap-4">
                <span class="text-6xl font-black tabular-nums">99,999</span>
                <span class="text-xl opacity-60">POINTS</span>
              </div>
              <div class="flex items-baseline gap-4">
                <span class="text-5xl font-black text-primary tabular-nums">+1,250</span>
                <span class="text-lg text-primary-80">BONUS</span>
              </div>
              <div class="grid grid-cols-3 gap-4 pt-4 border-t-2 border-background-20">
                <div>
                  <div class="text-xs opacity-60 mb-1">HP</div>
                  <div class="text-2xl font-black tabular-nums">100</div>
                </div>
                <div>
                  <div class="text-xs opacity-60 mb-1">MP</div>
                  <div class="text-2xl font-black tabular-nums text-primary">75</div>
                </div>
                <div>
                  <div class="text-xs opacity-60 mb-1">XP</div>
                  <div class="text-2xl font-black tabular-nums">999</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="p-8 rounded-lg border-2 bg-card border-border">
          <div class="mb-6">
            <h3 class="mb-2 text-foreground">System Messages</h3>
            <p class="text-muted-foreground">Notifications and alerts</p>
          </div>
          <div class="space-y-3">
            <div class="p-4 border-l-4 border-primary bg-primary-5">
              <p class="font-bold text-primary mb-1">Quest Complete!</p>
              <p class="text-sm text-foreground">You have earned 500 XP and unlocked a new ability.</p>
            </div>
            <div class="p-4 border-l-4 border-foreground bg-muted">
              <p class="font-bold text-foreground mb-1">Connection Lost</p>
              <p class="text-sm text-muted-foreground">Attempting to reconnect to server...</p>
            </div>
            <div class="p-4 border-l-4 border-secondary bg-secondary-5">
              <p class="font-bold text-secondary mb-1">Save Complete</p>
              <p class="text-sm text-foreground">Game progress has been saved.</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    

    <!-- In-Game Dialog -->
    <section class="max-w-7xl mx-auto px-8 py-16 bg-card-50">
      <div class="mb-12" style="display: flex; align-items: center; gap: 1.5rem;">
        <div>
          <h2 class="text-primary mb-2">IN-GAME DIALOG</h2>
          <p class="text-muted-foreground">Example of typography in context</p>
        </div>
        <button id="simulateBtn" style="padding: 1rem 1.5rem; background-color: var(--primary); border: 3px solid var(--foreground); cursor: pointer; transition: all 0.3s ease; font-family: Impact, sans-serif; font-weight: 900; font-size: 0.75rem; color: var(--primary-foreground); text-transform: uppercase; letter-spacing: 0.05em; display: flex; align-items: center; justify-content: center; text-align: center; line-height: 1.2;">
          CLICK TO SIMULATE
        </button>
      </div>

      <div class="space-y-8">
        
        <!-- Main Dialog Example -->
<div class="dialog-box bg-foreground text-background p-8 border-4 border-primary max-w-3xl">
  <div class="flex items-center gap-4 mb-6">
    <svg class="w-12 h-12 text-primary" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
    </svg>
    <div>
      <p class="text-sm uppercase tracking-wider opacity-60">NPC - Merchant</p>
      <p class="text-xl font-black">VENDOR MASTER ZEN</p>
    </div>
  </div>

  <div class="space-y-4 mb-6">
    <p class="text-lg leading-relaxed">
      "Ah, a brave warrior approaches! I have rare items that may aid you in your quest.
      These relics have been passed down through generations..."
    </p>
    <p class="text-lg leading-relaxed opacity-80">
      "But be warned — the path ahead is treacherous. You'll need more than just equipment
      to survive what lies beyond these gates."
    </p>
  </div>

  <div class="flex gap-4 pt-4 border-t-2 border-background-20">
    <button class="flex-1 px-6 py-3 bg-primary text-primary-foreground font-bold uppercase tracking-wide hover-bg-primary-90 transition-colors">
      Browse Shop
    </button>
    <button class="flex-1 px-6 py-3 border-2 border-background-20 font-bold uppercase tracking-wide hover-bg-background-10 transition-colors">
      Leave
    </button>
  </div>
</div>


        <!-- Additional Dialog Variations -->
        <div class="grid md-grid-cols-2 gap-8">
          <!-- Quest Dialog -->
          <div class="p-6 border-2 border-primary bg-card rounded-lg">
            <div class="flex items-center gap-3 mb-4">
              <svg class="w-8 h-8 text-primary" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="16" x2="12" y2="12"></line>
                <line x1="12" y1="8" x2="12.01" y2="8"></line>
              </svg>
              <div>
                <p class="text-xs text-muted-foreground uppercase tracking-wider">Quest Update</p>
                <p class="font-black text-foreground">MAIN OBJECTIVE</p>
              </div>
            </div>
            <p class="text-base text-foreground mb-4">
              Defeat the corrupted guardian protecting the ancient temple. Use fire-based attacks to exploit its weakness.
            </p>
            <div class="flex gap-2">
              <button class="px-4 py-2 bg-primary text-primary-foreground font-bold text-sm uppercase tracking-wide hover-bg-primary-90 transition-colors">
                Track
              </button>
              <button class="px-4 py-2 border-2 border-border text-foreground font-bold text-sm uppercase tracking-wide hover-bg-muted transition-colors">
                Ignore
              </button>
            </div>
          </div>

          <!-- Warning Dialog -->
          <div class="p-6 border-2 border-secondary bg-card rounded-lg">
            <div class="flex items-center gap-3 mb-4">
              <svg class="w-8 h-8 text-secondary" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                <line x1="12" y1="9" x2="12" y2="13"></line>
                <line x1="12" y1="17" x2="12.01" y2="17"></line>
              </svg>
              <div>
                <p class="text-xs text-muted-foreground uppercase tracking-wider">System Alert</p>
                <p class="font-black text-secondary">LOW HEALTH WARNING</p>
              </div>
            </div>
            <p class="text-base text-foreground mb-4">
              Your health is critically low. Consider using a health potion or retreating to a safe area before continuing.
            </p>
            <div class="flex gap-2">
              <button class="px-4 py-2 bg-secondary text-secondary-foreground font-bold text-sm uppercase tracking-wide hover-bg-secondary-90 transition-colors">
                Use Item
              </button>
              <button class="px-4 py-2 border-2 border-border text-foreground font-bold text-sm uppercase tracking-wide hover-bg-muted transition-colors">
                Dismiss
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Impact Font in Meme Culture -->
    <section class="max-w-7xl mx-auto px-8 py-4">
      <div class="mb-12">
        <h2 class="text-primary mb-2">IMPACT FONT IN MEME CULTURE</h2>
        <p class="text-muted-foreground">Why Impact became the universal language of internet humor</p>
      </div>

      <div class="grid md-grid-cols-2 gap-8 mb-12">
        <div class="p-8 rounded-lg border-2 bg-card border-border">
          <h3 class="mb-4 text-foreground font-black text-2xl">THE HISTORY</h3>
          <div class="space-y-4 text-base leading-relaxed">
            <p class="text-foreground">
              <span class="font-black text-primary">Impact</span> became the de facto meme font in the early 2000s due to its exceptional readability and bold presence.
            </p>
            <p class="text-muted-foreground">
              Its thick strokes with white outlines ensured text remained legible over any image, making it perfect for image macros and viral content.
            </p>
            <p class="text-foreground">
              The combination of <span class="font-black">TOP TEXT</span> and <span class="font-black">BOTTOM TEXT</span> became an iconic format that defined internet culture for over a decade.
            </p>
          </div>
        </div>

        <div class="p-8 rounded-lg border-2 bg-foreground border-primary">
          <h3 class="mb-4 text-background font-black text-2xl">TYPOGRAPHY FEATURES</h3>
          <div class="space-y-3">
            <div class="flex items-center gap-3 p-3 bg-primary-10 border-l-4 border-primary">
              <svg class="w-6 h-6 text-primary" viewBox="0 0 24 24">
                <polyline points="9 11 12 14 22 4"></polyline>
                <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
              </svg>
              <span class="text-background font-bold">HIGH CONTRAST & LEGIBILITY</span>
            </div>
            <div class="flex items-center gap-3 p-3 bg-primary-10 border-l-4 border-primary">
              <svg class="w-6 h-6 text-primary" viewBox="0 0 24 24">
                <polyline points="9 11 12 14 22 4"></polyline>
                <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
              </svg>
              <span class="text-background font-bold">BOLD WEIGHT FOR EMPHASIS</span>
            </div>
            <div class="flex items-center gap-3 p-3 bg-primary-10 border-l-4 border-primary">
              <svg class="w-6 h-6 text-primary" viewBox="0 0 24 24">
                <polyline points="9 11 12 14 22 4"></polyline>
                <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
              </svg>
              <span class="text-background font-bold">WHITE STROKE OUTLINE</span>
            </div>
            <div class="flex items-center gap-3 p-3 bg-primary-10 border-l-4 border-primary">
              <svg class="w-6 h-6 text-primary" viewBox="0 0 24 24">
                <polyline points="9 11 12 14 22 4"></polyline>
                <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
              </svg>
              <span class="text-background font-bold">ALL CAPS FOR MAXIMUM IMPACT</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Interactive Meme Generator Section -->
    <section class="max-w-7xl mx-auto px-8 py-6">
      <div class="mb-12">
        <h2 class="text-5xl mb-2">MEME GENERATOR</h2>
        <p class="text-muted-foreground">Click any meme to customize text and create your own</p>
      </div>

      <div class="grid md-grid-cols-2 lg-grid-cols-4 gap-8">
        <!-- Meme 1 - Trophy (High Score) -->
        <div class="meme-card" data-meme="1">
          <div class="meme-container">
            <div class="meme-bg" style="background: linear-gradient(135deg, #DC2626 0%, #991b1b 100%);">
              <div class="meme-icon-container">
                <svg class="meme-icon" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path>
                  <path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"></path>
                  <path d="M4 22h16"></path>
                  <path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"></path>
                  <path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"></path>
                  <path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"></path>
                </svg>
              </div>
            </div>
            <div class="meme-text-top">USE IMPACT GUYS!</div>
            <div class="meme-text-bottom">OR ELSE..</div>
          </div>
          <div class="meme-info">
            <p class="font-bold text-sm text-foreground">THREAT</p>
            <p class="text-xs text-muted-foreground">- PATRICK STAR</p>
          </div>
        </div>

        <!-- Meme 2 - Target (Level) -->
        <div class="meme-card" data-meme="2">
          <div class="meme-container">
            <div class="meme-bg" style="background: linear-gradient(135deg, #1F2937 0%, #111827 100%);">
              <div class="meme-icon-container">
                <svg class="meme-icon" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="10"></circle>
                  <circle cx="12" cy="12" r="6"></circle>
                  <circle cx="12" cy="12" r="2"></circle>
                </svg>
              </div>
            </div>
            <div class="meme-text-top">HOW IT FEELS</div>
            <div class="meme-text-bottom">TO USE IMPACT FONT</div>
          </div>
          <div class="meme-info">
            <p class="font-bold text-sm text-foreground">REALIZATION</p>
            <p class="text-xs text-muted-foreground">- JOHN PORK</p>
          </div>
        </div>


        <!-- Meme 3 - Lightning Bolt (Combo) -->
        <div class="meme-card" data-meme="3">
          <div class="meme-container">
            <div class="meme-bg" style="background: linear-gradient(135deg, #6B7280 0%, #4B5563 100%);">
              <div class="meme-icon-container">
                <svg class="meme-icon" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
                </svg>
              </div>
            </div>
            <div class="meme-text-top">SO TELL ME..</div>
            <div class="meme-text-bottom">WHATS THE BEEF WITH IMPACT?</div>
          </div>
          <div class="meme-info">
            <p class="font-bold text-sm text-foreground">BEEF</p>
            <p class="text-xs text-muted-foreground">- NICK YOUNG</p>
          </div>
        </div>

        <!-- Meme 4 - Crossed Swords (Power Max) -->
        <div class="meme-card" data-meme="4">
          <div class="meme-container">
            <div class="meme-bg" style="background: linear-gradient(135deg, #DC2626 20%, #1F2937 80%);">
              <div class="meme-icon-container">
                <svg class="meme-icon" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polyline points="14.5 17.5 3 6 3 3 6 3 17.5 14.5"></polyline>
                  <line x1="13" y1="19" x2="19" y2="13"></line>
                  <line x1="16" y1="16" x2="20" y2="20"></line>
                  <line x1="19" y1="21" x2="21" y2="19"></line>
                  <polyline points="14.5 6.5 18 3 21 3 21 6 17.5 9.5"></polyline>
                  <line x1="5" y1="14" x2="9" y2="18"></line>
                  <line x1="7" y1="17" x2="4" y2="20"></line>
                  <line x1="3" y1="19" x2="5" y2="21"></line>
                </svg>
              </div>
            </div>
            <div class="meme-text-top">HEY BUDDY..</div>
            <div class="meme-text-bottom">USE THIS FONT</div>
          </div>
          <div class="meme-info">
            <p class="font-bold text-sm text-foreground">SUGGESTION</p>
            <p class="text-xs text-muted-foreground">- PHILIP J. FRY</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="border-t-2 border-border mt-16">
      <div class="max-w-7xl mx-auto px-8 py-12">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-3">
            <svg class="w-6 h-6 text-primary" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="6" y1="11" x2="10" y2="11"></line>
              <line x1="8" y1="9" x2="8" y2="13"></line>
              <line x1="15" y1="12" x2="15.01" y2="12"></line>
              <line x1="18" y1="10" x2="18.01" y2="10"></line>
              <path d="M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z"></path>
            </svg>
            <span class="text-sm text-muted-foreground">IMPACT</span>
          </div>
          <div class="text-sm text-muted-foreground">
            Press <span class="px-2 py-1 bg-muted text-foreground font-mono">RETURN</span> to continue
          </div>
        </div>
      </div>
    </footer>
  </div>

  <script>
// ============================================================================
// MEME IMAGE CONFIGURATION
// ============================================================================
// EDIT THESE URLs TO CHANGE THE IMAGES FOR EACH MEME GENERATOR MODAL
const MEME_IMAGES = {
  '1': 'https://i.postimg.cc/NM0BGgsG/savage-patrick.jpg',  // Meme 1 (Trophy/Success)
  '2': 'https://i.postimg.cc/vmNRLCFH/John-Pork.webp',  // Meme 2 (Target/Realization)
  '3': 'https://i.postimg.cc/VNjMjPbZ/nyounp.png',  // Meme 3 (Lightning/Statement)
  '4': 'https://i.postimg.cc/SsFBvCRn/not-sure-if-fry.jpg'   // Meme 4 (Swords/Gaming)
};
// ============================================================================

// Page 2 - UI Button Modals
document.addEventListener('DOMContentLoaded', function() {
  console.log('Page 2 script loaded');
  

let sharedAudioContext = null;

 // Get all buttons in the Button Text section
  const buttonSection = document.querySelector('.button-section');
  if (buttonSection) {
    const startBtn = buttonSection.querySelector('.btn-start-game');
    const continueBtn = buttonSection.querySelector('.btn-continue');
    const settingsBtn = buttonSection.querySelector('.btn-settings');
    const quitBtn = buttonSection.querySelector('.btn-quit');
    
    // Start Game button
    if (startBtn) {
      startBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        showStartGamePopup();
      });
      console.log('Start Game button listener added');
    }

    // Continue button
    if (continueBtn) {
      continueBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        showContinuePopup();
      });
      console.log('Continue button listener added');
    }

    // Settings button
    if (settingsBtn) {
      settingsBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        showSettingsPopup();
      });
      console.log('Settings button listener added');
    }

    // Quit button
    if (quitBtn) {
      quitBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        showQuitPopup();
      });
      console.log('Quit button listener added');
    }
  }
          
  // Simulate Dialog Button
  initSimulateButton();
  
  // Initialize meme cards
  initMemeCards();
});

// Show Quit Popup - Confirmation dialog
function showQuitPopup() {
  const modal = document.createElement('div');
  modal.className = 'modal-overlay';
  modal.innerHTML = `
    <div class="modal-content" style="background-color: var(--foreground); border: 4px solid var(--secondary); padding: 2.5rem; border-radius: 0.5rem; min-width: 500px; max-width: 600px; clip-path: polygon(0 12px, 12px 12px, 12px 0, calc(100% - 12px) 0, calc(100% - 12px) 12px, 100% 12px, 100% calc(100% - 12px), calc(100% - 12px) calc(100% - 12px), calc(100% - 12px) 100%, 12px 100%, 12px calc(100% - 12px), 0 calc(100% - 12px));">
      <div class="absolute inset-0 scanline pointer-events-none opacity-30"></div>
      <div class="relative z-10">
        <div class="text-center mb-6">
          <div style="display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; width: 3rem; height: 3rem;">
            <svg style="width: 3rem; height: 3rem; stroke: white; fill: none; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;" viewBox="0 0 24 24">
              <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
              <line x1="12" y1="9" x2="12" y2="13"></line>
              <line x1="12" y1="17" x2="12.01" y2="17"></line>
            </svg>
          </div>
          <h2 class="text-3xl font-black text-background mb-1">QUIT GAME?</h2>
          <p class="text-sm text-muted" style="color: rgba(255, 255, 255, 0.7);">YOUR PROGRESS WILL BE LOST</p>
        </div>
        
        <div class="mb-6 p-4 border-2 border-background-20 text-center">
          <p class="text-lg text-background leading-relaxed">
            Are you sure you want to quit? All unsaved progress will be lost. This action cannot be undone.
          </p>
        </div>
        
        <div class="space-y-3 mb-6">
          <div class="p-4 bg-secondary-5 border-l-4 border-secondary">
            <div class="flex items-center gap-3">
              <svg class="w-6 h-6 text-secondary" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                <line x1="12" y1="9" x2="12" y2="13"></line>
                <line x1="12" y1="17" x2="12.01" y2="17"></line>
              </svg>
              <div>
                <p class="font-bold text-background text-sm">Last Save: 42 minutes ago</p>
                <p class="text-xs text-muted" style="color: rgba(255, 255, 255, 0.6);">You may lose recent progress</p>
              </div>
            </div>
          </div>
        </div>
        
        <div class="flex gap-3">
          <button class="flex-1 px-6 py-3 bg-secondary text-secondary-foreground font-bold uppercase tracking-wide hover-bg-secondary-90 transition-colors" onclick="this.closest('.modal-overlay').remove()">
            QUIT GAME
          </button>
          <button class="flex-1 px-6 py-3 border-2 border-background text-background font-bold uppercase tracking-wide hover-bg-background-10 transition-colors" onclick="this.closest('.modal-overlay').remove()">
            CANCEL
          </button>
        </div>
      </div>
    </div>
  `;

  document.body.appendChild(modal);

  modal.addEventListener('click', function(e) {
    if (e.target === modal) {
      modal.remove();
    }
  });

  const escapeHandler = function(e) {
    if (e.key === 'Escape') {
      modal.remove();
      document.removeEventListener('keydown', escapeHandler);
    }
  };
  document.addEventListener('keydown', escapeHandler);
}

// Show Start Game Popup - Difficulty selector interface
function showStartGamePopup() {
  const modal = document.createElement('div');
  modal.className = 'modal-overlay';
  modal.innerHTML = `
    <div class="modal-content" style="background-color: var(--primary); border: 4px solid var(--foreground); padding: 2.5rem; border-radius: 0.5rem; min-width: 500px; max-width: 600px; clip-path: polygon(0 12px, 12px 12px, 12px 0, calc(100% - 12px) 0, calc(100% - 12px) 12px, 100% 12px, 100% calc(100% - 12px), calc(100% - 12px) calc(100% - 12px), calc(100% - 12px) 100%, 12px 100%, 12px calc(100% - 12px), 0 calc(100% - 12px));">
      <div class="absolute inset-0 scanline pointer-events-none opacity-30"></div>
      <div class="relative z-10">
        <div class="text-center mb-6">
          <div class="modal-icon-center">
            <svg class="w-16 h-16 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polygon points="5 3 19 12 5 21 5 3"></polygon>
            </svg>
          </div>
          <h2 class="text-3xl font-black text-primary-foreground mb-1">START GAME</h2>
          <p class="text-sm text-muted-foreground" style="color: rgba(255, 255, 255, 0.7);">SELECT DIFFICULTY</p>
        </div>
        
        <div class="space-y-3 mb-6" style="display: flex; flex-direction: column; align-items: center;">
          <button class="px-6 py-4 bg-background text-foreground font-black text-xl uppercase tracking-wide hover-bg-primary hover-text-primary-foreground transition-colors text-center flex items-center justify-center gap-4" style="min-width: 400px;" onclick="this.closest('.modal-overlay').remove()">
            <span>EASY</span>
            <span class="text-sm opacity-60">DAMAGE ×0.5</span>
          </button>
          
          <button class="px-6 py-4 bg-background text-foreground font-black text-xl uppercase tracking-wide hover-bg-primary hover-text-primary-foreground transition-colors text-center flex items-center justify-center gap-4" style="min-width: 400px;" onclick="this.closest('.modal-overlay').remove()">
            <span>NORMAL</span>
            <span class="text-sm opacity-60">DAMAGE ×1.0</span>
          </button>
          
          <button class="px-6 py-4 bg-background text-foreground font-black text-xl uppercase tracking-wide hover-bg-primary hover-text-primary-foreground transition-colors text-center flex items-center justify-center gap-4" style="min-width: 400px;" onclick="this.closest('.modal-overlay').remove()">
            <span>HARD</span>
            <span class="text-sm opacity-60">DAMAGE ×2.0</span>
          </button>
          
          <button class="px-6 py-4 border-2 border-background text-background font-black text-xl uppercase tracking-wide hover-bg-background-10 transition-colors text-center flex items-center justify-center gap-4" style="min-width: 400px;" onclick="this.closest('.modal-overlay').remove()">
            <span>NIGHTMARE</span>
            <span class="text-sm opacity-80">DAMAGE ×5.0</span>
          </button>
        </div>
        
        <div style="display: flex; justify-content: center;">
          <button class="px-6 py-3 border-2 border-background text-background font-bold uppercase tracking-wide hover-bg-background-10 transition-colors" style="min-width: 200px;" onclick="this.closest('.modal-overlay').remove()">
            CANCEL
          </button>
        </div>
      </div>
    </div>
  `;

  document.body.appendChild(modal);

  modal.addEventListener('click', function(e) {
    if (e.target === modal) {
      modal.remove();
    }
  });

  const escapeHandler = function(e) {
    if (e.key === 'Escape') {
      modal.remove();
      document.removeEventListener('keydown', escapeHandler);
    }
  };
  document.addEventListener('keydown', escapeHandler);
}

// Show Continue Popup - Saved games interface
function showContinuePopup() {
  const modal = document.createElement('div');
  modal.className = 'modal-overlay';
  modal.innerHTML = `
    <div class="modal-content" style="background-color: var(--foreground); border: 4px solid var(--primary); padding: 2.5rem; border-radius: 0.5rem; min-width: 500px; max-width: 600px; clip-path: polygon(0 12px, 12px 12px, 12px 0, calc(100% - 12px) 0, calc(100% - 12px) 12px, 100% 12px, 100% calc(100% - 12px), calc(100% - 12px) calc(100% - 12px), calc(100% - 12px) 100%, 12px 100%, 12px calc(100% - 12px), 0 calc(100% - 12px));">
      <div class="absolute inset-0 scanline pointer-events-none opacity-30"></div>
      <div class="relative z-10">
        <div class="text-center mb-6">
          <div style="display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; width: 3rem; height: 3rem;">
            <svg style="width: 3rem; height: 3rem; stroke: white; fill: none; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;" viewBox="0 0 24 24">
              <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
              <polyline points="17 21 17 13 7 13 7 21"></polyline>
              <polyline points="7 3 7 8 15 8"></polyline>
            </svg>
          </div>
          <h2 class="text-3xl font-black text-background mb-1">CONTINUE</h2>
          <p class="text-sm text-muted" style="color: rgba(255, 255, 255, 0.7);">LOAD SAVED GAME</p>
        </div>
        
        <div class="space-y-3 mb-6">
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem;">
            <button class="px-6 py-4 bg-background text-foreground font-bold uppercase tracking-wide hover-bg-primary hover-text-primary-foreground transition-colors text-left border-2 border-background" onclick="this.closest('.modal-overlay').remove()">
              <div class="flex items-center justify-between mb-2">
                <span class="text-xl font-black">SLOT 1</span>
                <span class="text-sm opacity-60">LEVEL 42</span>
              </div>
              <div class="flex items-center gap-4 text-sm">
                <span>FOREST TEMPLE</span>
                <span class="opacity-60">•</span>
                <span class="opacity-60">12/14/2025</span>
              </div>
            </button>
            
            <div class="px-6 py-4 border-2 border-background text-background font-bold uppercase tracking-wide opacity-30 text-center" style="display: flex; align-items: center; justify-content: center;">
              <span class="text-xl font-black">EMPTY</span>
            </div>
          </div>
          
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem;">
            <button class="px-6 py-4 bg-background text-foreground font-bold uppercase tracking-wide hover-bg-primary hover-text-primary-foreground transition-colors text-left border-2 border-background" onclick="this.closest('.modal-overlay').remove()">
              <div class="flex items-center justify-between mb-2">
                <span class="text-xl font-black">SLOT 2</span>
                <span class="text-sm opacity-60">LEVEL 28</span>
              </div>
              <div class="flex items-center gap-4 text-sm">
                <span>MOUNTAIN PASS</span>
                <span class="opacity-60">•</span>
                <span class="opacity-60">12/10/2025</span>
              </div>
            </button>
            
            <div class="px-6 py-4 border-2 border-background text-background font-bold uppercase tracking-wide opacity-30 text-center" style="display: flex; align-items: center; justify-content: center;">
              <span class="text-xl font-black">EMPTY</span>
            </div>
          </div>
        </div>
        
        <button class="w-full px-6 py-3 border-2 border-background text-background font-bold uppercase tracking-wide hover-bg-background-10 transition-colors" onclick="this.closest('.modal-overlay').remove()">
          CANCEL
        </button>
      </div>
    </div>
  `;

  document.body.appendChild(modal);

  modal.addEventListener('click', function(e) {
    if (e.target === modal) {
      modal.remove();
    }
  });

  const escapeHandler = function(e) {
    if (e.key === 'Escape') {
      modal.remove();
      document.removeEventListener('keydown', escapeHandler);
    }
  };
  document.addEventListener('keydown', escapeHandler);
}

// Show Settings Popup - Game settings interface
function showSettingsPopup() {
  const modal = document.createElement('div');
  modal.className = 'modal-overlay';
  modal.innerHTML = `
    <div class="modal-content" style="background-color: var(--card); border: 4px solid var(--primary); padding: 2.5rem; border-radius: 0.5rem; min-width: 500px; max-width: 600px; clip-path: polygon(0 12px, 12px 12px, 12px 0, calc(100% - 12px) 0, calc(100% - 12px) 12px, 100% 12px, 100% calc(100% - 12px), calc(100% - 12px) calc(100% - 12px), calc(100% - 12px) 100%, 12px 100%, 12px calc(100% - 12px), 0 calc(100% - 12px));">
      <div class="absolute inset-0 scanline pointer-events-none opacity-30"></div>
      <div class="relative z-10">
        <div class="text-center mb-6">
          <div class="modal-icon-center">
            <svg class="w-16 h-16 text-primary" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="3"/>
              <line x1="12" y1="1" x2="12" y2="4"/>
              <line x1="12" y1="20" x2="12" y2="23"/>
              <line x1="1" y1="12" x2="4" y2="12"/>
              <line x1="20" y1="12" x2="23" y2="12"/>
              <line x1="4.22" y1="4.22" x2="6.34" y2="6.34"/>
              <line x1="17.66" y1="17.66" x2="19.78" y2="19.78"/>
              <line x1="4.22" y1="19.78" x2="6.34" y2="17.66"/>
              <line x1="17.66" y1="6.34" x2="19.78" y2="4.22"/>
            </svg>
          </div>
          <h2 class="text-3xl font-black text-primary mb-1">SETTINGS</h2>
          <p class="text-sm text-muted-foreground">CONFIGURE GAME OPTIONS</p>
        </div>
        
        <div class="space-y-4 mb-6">
          <div class="slider-container">
            <div class="flex items-center justify-between mb-2">
              <span class="font-black text-foreground uppercase">MASTER VOLUME</span>
              <span class="text-primary font-bold" id="masterValue">75%</span>
            </div>
            <div class="slider-track w-full h-3 bg-muted border-2 border-border" style="position: relative; cursor: pointer;">
              <div class="slider-fill h-full bg-primary" style="width: 75%; pointer-events: none;"></div>
              <div class="slider-knob" style="position: absolute; top: 50%; left: 75%; transform: translate(-50%, -50%); width: 1.25rem; height: 1.25rem; background-color: var(--primary); border: 2px solid var(--background); border-radius: 50%; cursor: grab; z-index: 10;"></div>
            </div>
          </div>
          
          <div class="slider-container">
            <div class="flex items-center justify-between mb-2">
              <span class="font-black text-foreground uppercase">MUSIC VOLUME</span>
              <span class="text-primary font-bold" id="musicValue">60%</span>
            </div>
            <div class="slider-track w-full h-3 bg-muted border-2 border-border" style="position: relative; cursor: pointer;">
              <div class="slider-fill h-full bg-primary" style="width: 60%; pointer-events: none;"></div>
              <div class="slider-knob" style="position: absolute; top: 50%; left: 60%; transform: translate(-50%, -50%); width: 1.25rem; height: 1.25rem; background-color: var(--primary); border: 2px solid var(--background); border-radius: 50%; cursor: grab; z-index: 10;"></div>
            </div>
          </div>
          
          <div class="slider-container">
            <div class="flex items-center justify-between mb-2">
              <span class="font-black text-foreground uppercase">SFX VOLUME</span>
              <span class="text-primary font-bold" id="sfxValue">80%</span>
            </div>
            <div class="slider-track w-full h-3 bg-muted border-2 border-border" style="position: relative; cursor: pointer;">
              <div class="slider-fill h-full bg-primary" style="width: 80%; pointer-events: none;"></div>
              <div class="slider-knob" style="position: absolute; top: 50%; left: 80%; transform: translate(-50%, -50%); width: 1.25rem; height: 1.25rem; background-color: var(--primary); border: 2px solid var(--background); border-radius: 50%; cursor: grab; z-index: 10;"></div>
            </div>
          </div>
          
          <div class="border-t-2 border-border pt-4">
            <div class="flex items-center justify-between mb-3">
              <span class="font-black text-foreground uppercase">DISPLAY MODE</span>
              <button id="fullscreenToggle" class="px-6 py-2 bg-primary text-primary-foreground text-sm font-bold uppercase hover-bg-primary-90 transition-colors" style="border: none; cursor: pointer;">FULLSCREEN</button>
            </div>
            
            <div class="flex items-center justify-between mb-3">
              <span class="font-black text-foreground uppercase">V-SYNC</span>
              <span class="px-6 py-2 bg-secondary text-secondary-foreground text-sm font-bold uppercase">ON</span>
            </div>
            
            <div class="flex items-center justify-between">
              <span class="font-black text-foreground uppercase">SUBTITLES</span>
              <span class="px-6 py-2 bg-secondary text-secondary-foreground text-sm font-bold uppercase">ON</span>
            </div>
          </div>
        </div>
        
        <div class="flex gap-3">
          <button class="flex-1 px-6 py-3 bg-primary text-primary-foreground font-bold uppercase tracking-wide hover-bg-primary-90 transition-colors" onclick="this.closest('.modal-overlay').remove()">
            APPLY
          </button>
          <button class="flex-1 px-6 py-3 border-2 border-primary text-primary font-bold uppercase tracking-wide hover-bg-primary hover-text-primary-foreground transition-colors" onclick="this.closest('.modal-overlay').remove()">
            CANCEL
          </button>
        </div>
      </div>
    </div>
  `;

  document.body.appendChild(modal);

  // Initialize sliders AFTER modal is added to DOM
  initSliders();

  // Initialize fullscreen toggle
  initFullscreenToggle();

  modal.addEventListener('click', function(e) {
    if (e.target === modal) {
      modal.remove();
    }
  });

  const escapeHandler = function(e) {
    if (e.key === 'Escape') {
      modal.remove();
      document.removeEventListener('keydown', escapeHandler);
    }
  };
  document.addEventListener('keydown', escapeHandler);
}

// Slider functionality
function initSliders() {
  const sliders = document.querySelectorAll('.slider-container');

  sliders.forEach(slider => {
    const track = slider.querySelector('.slider-track');
    const fill = slider.querySelector('.slider-fill');
    const knob = slider.querySelector('.slider-knob');
    const valueDisplay = slider.querySelector('span[id$="Value"]');

    let dragging = false;

    const updateSlider = (clientX) => {
      const rect = track.getBoundingClientRect();
      let percent = (clientX - rect.left) / rect.width;
      percent = Math.min(Math.max(percent, 0), 1); // clamp 0-1
      const percentValue = Math.round(percent * 100);

      // Update fill and knob
      fill.style.width = `${percentValue}%`;
      knob.style.left = `${percentValue}%`;

      // Update text
      valueDisplay.textContent = `${percentValue}%`;
    };

    knob.addEventListener('mousedown', (e) => {
      dragging = true;
      knob.style.cursor = 'grabbing';
      e.preventDefault();
    });

    document.addEventListener('mousemove', (e) => {
      if (dragging) updateSlider(e.clientX);
    });

    document.addEventListener('mouseup', () => {
      if (dragging) {
        dragging = false;
        knob.style.cursor = 'grab';
      }
    });

    // Allow clicking on track to set value
    track.addEventListener('click', (e) => {
      updateSlider(e.clientX);
    });
  });
}

// Fullscreen toggle functionality
function initFullscreenToggle() {
  const fullscreenToggle = document.getElementById('fullscreenToggle');
  
  // Set initial button text based on current fullscreen state
  if (document.fullscreenElement) {
    fullscreenToggle.textContent = 'EXIT FULLSCREEN';
  } else {
    fullscreenToggle.textContent = 'FULLSCREEN';
  }

  fullscreenToggle.addEventListener('click', () => {
    if (!document.fullscreenElement) {
      document.documentElement.requestFullscreen();
      fullscreenToggle.textContent = 'EXIT FULLSCREEN';
      localStorage.setItem('fullscreen', 'true');
    } else {
      document.exitFullscreen();
      fullscreenToggle.textContent = 'FULLSCREEN';
      localStorage.setItem('fullscreen', 'false');
    }
  });

  // Listen for fullscreen changes (e.g., user presses ESC)
  document.addEventListener('fullscreenchange', () => {
    if (fullscreenToggle) {
      if (document.fullscreenElement) {
        fullscreenToggle.textContent = 'EXIT FULLSCREEN';
        localStorage.setItem('fullscreen', 'true');
      } else {
        fullscreenToggle.textContent = 'FULLSCREEN';
        localStorage.setItem('fullscreen', 'false');
      }
    }
  });
}

// Check and apply fullscreen state from localStorage
function checkFullscreenState() {
  const fullscreenState = localStorage.getItem('fullscreen');
  if (fullscreenState === 'true' && !document.fullscreenElement) {
    // Try to enter fullscreen immediately
    document.documentElement.requestFullscreen().catch(err => {
      // If it fails (due to browser restrictions), show a prompt
      console.log('Fullscreen request failed, showing prompt');
      showFullscreenPrompt();
    });
  }
}

// Show a prompt to re-enter fullscreen
function showFullscreenPrompt() {
  const prompt = document.createElement('div');
  prompt.style.cssText = `
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background-color: var(--primary);
    color: var(--primary-foreground);
    padding: 1rem 2rem;
    border: 3px solid var(--foreground);
    font-family: Impact, sans-serif;
    font-weight: bold;
    text-align: center;
    z-index: 9999;
    cursor: pointer;
    clip-path: polygon(0 8px, 8px 8px, 8px 0, calc(100% - 8px) 0, calc(100% - 8px) 8px, 100% 8px, 100% calc(100% - 8px), calc(100% - 8px) calc(100% - 8px), calc(100% - 8px) 100%, 8px 100%, 8px calc(100% - 8px), 0 calc(100% - 8px));
    animation: slideDown 0.3s ease-out;
  `;
  prompt.innerHTML = `
    <div style="font-size: 0.875rem; margin-bottom: 0.25rem;">FULLSCREEN MODE ENABLED</div>
    <div style="font-size: 1.125rem;">CLICK TO ENTER FULLSCREEN</div>
  `;
  
  // Add animation
  const style = document.createElement('style');
  style.textContent = `
    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateX(-50%) translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
      }
    }
    
    @keyframes spin {
      from {
        transform: rotate(0deg);
      }
      to {
        transform: rotate(360deg);
      }
    }
    
    .spinning-circle-btn {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .spinning-circle-btn:hover {
      border-width: 4px;
      box-shadow: 0 0 20px rgba(220, 38, 38, 0.5);
    }
    
    .spinning-circle-btn:active {
      animation: spin 8s linear infinite, scaleBtn 0.1s ease-out;
    }
    
    @keyframes scaleBtn {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(0.95); }
    }
  `;
  document.head.appendChild(style);
  
  prompt.addEventListener('click', () => {
    document.documentElement.requestFullscreen();
    prompt.remove();
  });
  
  document.body.appendChild(prompt);
  
  // Auto-remove after 10 seconds
  setTimeout(() => {
    if (prompt.parentElement) {
      prompt.remove();
    }
  }, 10000);
}

// Simulate Dialog Button
function initSimulateButton() {
  const simulateBtn = document.getElementById('simulateBtn');
  
  if (simulateBtn) {
    // Add hover effect
    simulateBtn.addEventListener('mouseenter', () => {
      simulateBtn.style.backgroundColor = 'var(--foreground)';
      simulateBtn.style.color = 'var(--primary)';
      simulateBtn.style.transform = 'scale(1.05)';
    });
    
    simulateBtn.addEventListener('mouseleave', () => {
      simulateBtn.style.backgroundColor = 'var(--primary)';
      simulateBtn.style.color = 'var(--primary-foreground)';
      simulateBtn.style.transform = 'scale(1)';
    });
    
    let dialogIndex = 0;
    const dialogs = [
      {
        npc: 'NPC - Merchant',
        name: 'VENDOR MASTER ZEN',
        icon: '<path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>',
        text1: '"Ah, a brave warrior approaches! I have rare items that may aid you in your quest. These relics have been passed down through generations..."',
        text2: '"But be warned - the path ahead is treacherous. You\'ll need more than just equipment to survive what lies beyond these gates."',
        button1: 'Browse Shop',
        button2: 'Leave'
      },
      {
        npc: 'NPC - Quest Giver',
        name: 'ELDER SAGE ARIA',
        icon: '<circle cx="12" cy="8" r="5"></circle><path d="M20 21a8 8 0 0 0-16 0"></path>',
        text1: '"Welcome, traveler. I have a task that requires someone of your unique abilities. Deep in the cursed forest, an ancient artifact has been stolen..."',
        text2: '"Retrieve it, and you shall be rewarded handsomely. But many have tried and failed. Do you accept this dangerous mission?"',
        button1: 'Accept Quest',
        button2: 'Decline'
      },
      {
        npc: 'NPC - Blacksmith',
        name: 'FORGE MASTER GROM',
        icon: '<path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path>',
        text1: '"Your blade is looking worn, adventurer. I can forge you something much stronger with the right materials and coin..."',
        text2: '"Bring me dragon scales and mithril ore, and I\'ll craft you a weapon worthy of legends. What do you say?"',
        button1: 'Upgrade Weapon',
        button2: 'Not Now'
      }
    ];
    
    simulateBtn.addEventListener('click', () => {
      // Play looping Zelda-style melody and store the stop function
      const stopMusic = playMedievalMelody();
      
      dialogIndex = (dialogIndex + 1) % dialogs.length;
      const dialog = dialogs[dialogIndex];
      
      // Create modal overlay
      const modal = document.createElement('div');
      modal.className = 'modal-overlay';
      modal.innerHTML = `
        <div class="modal-content" style="background-color: var(--foreground); border: 4px solid var(--primary); padding: 2rem; border-radius: 0; max-width: 700px; clip-path: polygon(0 12px, 12px 12px, 12px 0, calc(100% - 12px) 0, calc(100% - 12px) 12px, 100% 12px, 100% calc(100% - 12px), calc(100% - 12px) calc(100% - 12px), calc(100% - 12px) 100%, 12px 100%, 12px calc(100% - 12px), 0 calc(100% - 12px));">
          <div class="absolute inset-0 scanline pointer-events-none opacity-20"></div>
          <div class="relative z-10">
            <div class="flex items-center gap-4 mb-6">
              <svg class="w-12 h-12 text-primary" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                ${dialog.icon}
              </svg>
              <div>
                <p class="text-sm uppercase tracking-wider opacity-60" style="color: rgba(255, 255, 255, 0.6);">${dialog.npc}</p>
                <p class="text-xl font-black" style="color: var(--background); font-family: Impact, sans-serif;">${dialog.name}</p>
              </div>
            </div>
            <div class="space-y-4 mb-6">
              <p class="text-lg leading-relaxed" style="color: var(--background); font-family: Impact, sans-serif;">
                ${dialog.text1}
              </p>
              <p class="text-lg leading-relaxed opacity-80" style="color: var(--background); font-family: Impact, sans-serif;">
                ${dialog.text2}
              </p>
            </div>
            <div class="flex gap-4 pt-4 border-t-2" style="border-color: rgba(255, 255, 255, 0.2);">
              <button class="dialog-close-btn flex-1 px-6 py-3 bg-primary text-primary-foreground font-bold uppercase tracking-wide hover-bg-primary-90 transition-colors" style="background-color: var(--primary); color: var(--primary-foreground); border: none; cursor: pointer; font-family: Impact, sans-serif; font-weight: 900;">
                ${dialog.button1}
              </button>
              <button class="dialog-close-btn flex-1 px-6 py-3 border-2 font-bold uppercase tracking-wide hover-bg-background-10 transition-colors" style="border: 2px solid rgba(255, 255, 255, 0.2); background: transparent; color: var(--background); cursor: pointer; font-family: Impact, sans-serif; font-weight: 900;">
                ${dialog.button2}
              </button>
            </div>
          </div>
        </div>
      `;
      
      document.body.appendChild(modal);
      
      // Function to close modal and stop music
      const closeModal = () => {
        stopMusic(); // Stop the looping music
        modal.remove();
      };
      
      // Close modal on button clicks
      const closeButtons = modal.querySelectorAll('.dialog-close-btn');
      closeButtons.forEach(btn => {
        btn.addEventListener('click', closeModal);
      });
      
      // Close modal on background click AND STOP MUSIC
      modal.addEventListener('click', function(e) {
        if (e.target === modal) {
          closeModal();
        }
      });
      
      // Close modal on ESC key AND STOP MUSIC
   
      document.addEventListener('keydown', escapeHandler);
    });
  }
}

// Medieval Fantasy Melody using Web Audio API
function playMedievalMelody() {
  const audioContext = new (window.AudioContext || window.webkitAudioContext)();

  audioContext.resume();

  // Final Fantasy-inspired epic fantasy melody
  // Based on the iconic main theme structure
  const melodyPhrases = [
    // Phrase 1 - Opening theme (inspired by FF main theme)
    [
      { freq: 349.23, duration: 0.5 },   // F4 - opening
      { freq: 523.25, duration: 0.3 },   // C5
      { freq: 659.25, duration: 0.3 },   // E5
      { freq: 466.16, duration: 0.35 },  // Bb4
      { freq: 587.33, duration: 0.3 },   // D5
      { freq: 440.00, duration: 0.35 },  // A4
      { freq: 523.25, duration: 0.4 },   // C5
      { freq: 493.88, duration: 0.35 },  // B4
      { freq: 392.00, duration: 0.35 },  // G4
      { freq: 493.88, duration: 0.3 },   // B4
      { freq: 523.25, duration: 0.6 }    // C5 - resolution
    ],
    // Phrase 2 - Heroic variation
    [
      { freq: 392.00, duration: 0.3 },   // G4
      { freq: 587.33, duration: 0.3 },   // D5
      { freq: 392.00, duration: 0.25 },  // G4
      { freq: 349.23, duration: 0.35 },  // F4
      { freq: 392.00, duration: 0.3 },   // G4
      { freq: 783.99, duration: 0.25 },  // G5
      { freq: 698.46, duration: 0.3 },   // F5
      { freq: 523.25, duration: 0.4 },   // C5
      { freq: 587.33, duration: 0.35 }   // D5
    ],
    // Phrase 3 - Soaring melody
    [
      { freq: 466.16, duration: 0.35 },  // Bb4
      { freq: 349.23, duration: 0.3 },   // F4
      { freq: 392.00, duration: 0.25 },  // G4
      { freq: 466.16, duration: 0.3 },   // Bb4
      { freq: 587.33, duration: 0.35 },  // D5
      { freq: 392.00, duration: 0.3 },   // G4
      { freq: 349.23, duration: 0.4 },   // F4
      { freq: 293.66, duration: 0.25 },  // D4
      { freq: 349.23, duration: 0.5 }    // F4
    ],
    // Phrase 4 - Epic conclusion
    [
      { freq: 415.30, duration: 0.4 },   // Ab4
      { freq: 392.00, duration: 0.3 },   // G4
      { freq: 349.23, duration: 0.35 },  // F4
      { freq: 311.13, duration: 0.3 },   // Eb4
      { freq: 349.23, duration: 0.4 },   // F4
      { freq: 466.16, duration: 0.35 },  // Bb4
      { freq: 523.25, duration: 0.6 }    // C5 - final resolution
    ]
  ];
  
  let isPlaying = true;
  let loopTimeout;
  let phraseIndex = 0;
  
  const playMelodyLoop = () => {
    if (!isPlaying) return;
    
    // Get current phrase and cycle through them
    const currentPhrase = melodyPhrases[phraseIndex];
    phraseIndex = (phraseIndex + 1) % melodyPhrases.length;
    
    let currentTime = audioContext.currentTime;
    let totalDuration = 0;
    
    currentPhrase.forEach((note, index) => {
      // Create oscillator for epic orchestral flute sound
      const oscillator = audioContext.createOscillator();
      const gainNode = audioContext.createGain();
      
      // Use sine wave for pure, clear tone
      oscillator.type = 'sine';
      oscillator.frequency.setValueAtTime(note.freq, currentTime);
      
      // Add subtle vibrato for expressiveness
      const vibrato = audioContext.createOscillator();
      const vibratoGain = audioContext.createGain();
      vibrato.type = 'sine';
      vibrato.frequency.setValueAtTime(5.5, currentTime); // 5.5Hz vibrato
      vibratoGain.gain.setValueAtTime(10, currentTime); // Moderate pitch variation
      
      vibrato.connect(vibratoGain);
      vibratoGain.connect(oscillator.frequency);
      
      vibrato.start(currentTime);
      vibrato.stop(currentTime + note.duration);
      
      // Create envelope for orchestral flute with expression
      gainNode.gain.setValueAtTime(0, currentTime);
      gainNode.gain.linearRampToValueAtTime(0.18, currentTime + 0.04); // Expressive attack
      gainNode.gain.linearRampToValueAtTime(0.16, currentTime + note.duration - 0.1); // Sustain
      gainNode.gain.exponentialRampToValueAtTime(0.01, currentTime + note.duration); // Smooth release
      
      oscillator.connect(gainNode);
      gainNode.connect(audioContext.destination);
      
      oscillator.start(currentTime);
      oscillator.stop(currentTime + note.duration);
      
      currentTime += note.duration;
      totalDuration += note.duration;
    });
    
    // Add harmonic layer for orchestral richness
    currentTime = audioContext.currentTime;
    currentPhrase.forEach((note) => {
      const harmonic = audioContext.createOscillator();
      const harmonicGain = audioContext.createGain();
      
      harmonic.type = 'triangle';
      harmonic.frequency.setValueAtTime(note.freq * 2, currentTime); // Octave above
      
      harmonicGain.gain.setValueAtTime(0, currentTime);
      harmonicGain.gain.linearRampToValueAtTime(0.04, currentTime + 0.03);
      harmonicGain.gain.linearRampToValueAtTime(0.035, currentTime + note.duration - 0.08);
      harmonicGain.gain.exponentialRampToValueAtTime(0.01, currentTime + note.duration);
      
      harmonic.connect(harmonicGain);
      harmonicGain.connect(audioContext.destination);
      
      harmonic.start(currentTime);
      harmonic.stop(currentTime + note.duration);
      
      currentTime += note.duration;
    });
    
    // Add warm bass foundation
    currentTime = audioContext.currentTime;
    currentPhrase.forEach((note) => {
      const bass = audioContext.createOscillator();
      const bassGain = audioContext.createGain();
      
      bass.type = 'sine';
      bass.frequency.setValueAtTime(note.freq * 0.5, currentTime); // Octave below
      
      bassGain.gain.setValueAtTime(0, currentTime);
      bassGain.gain.linearRampToValueAtTime(0.06, currentTime + 0.03);
      bassGain.gain.linearRampToValueAtTime(0.05, currentTime + note.duration - 0.08);
      bassGain.gain.exponentialRampToValueAtTime(0.01, currentTime + note.duration);
      
      bass.connect(bassGain);
      bassGain.connect(audioContext.destination);
      
      bass.start(currentTime);
      bass.stop(currentTime + note.duration);
      
      currentTime += note.duration;
    });
    
    // Add ambient orchestral pad
    const pad = audioContext.createOscillator();
    const padGain = audioContext.createGain();
    
    pad.type = 'triangle';
    pad.frequency.setValueAtTime(261.63, audioContext.currentTime); // C4
    padGain.gain.setValueAtTime(0.035, audioContext.currentTime);
    
    pad.connect(padGain);
    padGain.connect(audioContext.destination);
    
    pad.start(audioContext.currentTime);
    pad.stop(audioContext.currentTime + totalDuration);
    
    // Schedule next loop with brief pause
    loopTimeout = setTimeout(playMelodyLoop, (totalDuration + 0.4) * 1000);
  };
  
  // Start the loop
  playMelodyLoop();
  
  // Return stop function
  return () => {
    isPlaying = false;
    clearTimeout(loopTimeout);
  };
}

// Initialize Meme Cards
function initMemeCards() {
  const memeCards = document.querySelectorAll('.meme-card');
  
  memeCards.forEach(card => {
    card.addEventListener('click', function() {
      const memeId = this.getAttribute('data-meme');
      const topText = this.querySelector('.meme-text-top').textContent;
      const bottomText = this.querySelector('.meme-text-bottom').textContent;
      
      showMemeEditor(memeId, topText, bottomText, this);
    });
  });
}

// Show Meme Editor
function showMemeEditor(memeId, topText, bottomText, cardElement) {
  const modal = document.createElement('div');
  modal.className = 'modal-overlay';
  modal.innerHTML = `
    <div class="meme-modal-content" style="background-color: var(--card); border: 3px solid var(--primary); padding: 1.5rem; border-radius: 0.5rem; width: 90%; max-width: 650px; clip-path: polygon(0 8px, 8px 8px, 8px 0, calc(100% - 8px) 0, calc(100% - 8px) 8px, 100% 8px, 100% calc(100% - 8px), calc(100% - 8px) calc(100% - 8px), calc(100% - 8px) 100%, 8px 100%, 8px calc(100% - 8px), 0 calc(100% - 8px));">
      <div class="absolute inset-0 scanline pointer-events-none opacity-30"></div>
      <div class="relative z-10">
        <div class="text-center mb-4">
          <div class="modal-icon-center">
            <svg class="w-12 h-12 text-primary" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
              <circle cx="8.5" cy="8.5" r="1.5"></circle>
              <polyline points="21 15 16 10 5 21"></polyline>
            </svg>
          </div>
          <h2 class="text-2xl font-black text-primary mb-1">CUSTOMIZE MEME</h2>
          <p class="text-xs text-muted-foreground">Edit text to create your own version</p>
        </div>
        
        <!-- Preview and Inputs Grid -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
          <!-- Preview -->
          <div>
            <div class="meme-container-preview-editor">
              <div class="meme-bg" style="${cardElement.querySelector('.meme-bg').getAttribute('style')}">
                <div class="meme-icon-container" id="iconContainer">
                  ${cardElement.querySelector('.meme-icon-container').innerHTML}
                </div>
              </div>
              <div class="meme-text-top-small" id="previewTop">${topText}</div>
              <div class="meme-text-bottom-small" id="previewBottom">${bottomText}</div>
            </div>
          </div>
          
          <!-- Text Inputs -->
          <div style="display: flex; flex-direction: column; justify-content: center; gap: 0.75rem;">
            <div>
              <label class="block font-black text-foreground uppercase mb-1 text-xs">Top Text</label>
              <input type="text" id="topTextInput" value="${topText}" class="w-full px-3 py-2 border-2 border-border bg-background text-foreground font-bold uppercase text-sm" maxlength="50" style="font-family: Impact, sans-serif;">
            </div>
            <div>
              <label class="block font-black text-foreground uppercase mb-1 text-xs">Bottom Text</label>
              <input type="text" id="bottomTextInput" value="${bottomText}" class="w-full px-3 py-2 border-2 border-border bg-background text-foreground font-bold uppercase text-sm" maxlength="50" style="font-family: Impact, sans-serif;">
            </div>
            <button id="generateImageBtn" class="image-generator-btn px-4 py-4 bg-primary border-2 border-foreground text-primary-foreground font-bold uppercase tracking-wide text-xs transition-all">
              <span id="btnText">GENERATE IMAGE</span>
              <svg id="btnLoader" class="circle-loader" style="display: none; width: 20px; height: 20px; margin: 0 auto;" viewBox="0 0 50 50">
                <circle cx="25" cy="25" r="20" fill="none" stroke="white" stroke-width="4" stroke-dasharray="31.4 31.4" stroke-linecap="round"></circle>
              </svg>
            </button>
          </div>
        </div>
        
        <div class="flex gap-2">
          <button id="applyBtn" class="flex-1 px-4 py-2 bg-primary text-primary-foreground font-bold uppercase tracking-wide text-sm hover-bg-primary-90 transition-colors">
            APPLY
          </button>
          <button class="flex-1 px-4 py-2 border-2 border-primary text-primary font-bold uppercase tracking-wide text-sm hover-bg-primary hover-text-primary-foreground transition-colors" onclick="this.closest('.modal-overlay').remove()">
            CANCEL
          </button>
        </div>
      </div>
    </div>
  `;

  document.body.appendChild(modal);

  // Real-time preview update
  const topInput = modal.querySelector('#topTextInput');
  const bottomInput = modal.querySelector('#bottomTextInput');
  const previewTop = modal.querySelector('#previewTop');
  const previewBottom = modal.querySelector('#previewBottom');

  topInput.addEventListener('input', (e) => {
    previewTop.textContent = e.target.value || topText;
  });

  bottomInput.addEventListener('input', (e) => {
    previewBottom.textContent = e.target.value || bottomText;
  });

  // Image generator button functionality
  const generateBtn = modal.querySelector('#generateImageBtn');
  const iconContainer = modal.querySelector('#iconContainer');
  const btnText = modal.querySelector('#btnText');
  const btnLoader = modal.querySelector('#btnLoader');
  
  let currentImage = null;
  const originalIcon = iconContainer.innerHTML;
  
  generateBtn.addEventListener('click', () => {
    // Show loader
    btnText.style.display = 'none';
    btnLoader.style.display = 'block';
    generateBtn.disabled = true;
    generateBtn.style.cursor = 'not-allowed';
    
    // Simulate loading for 2-3 seconds
    setTimeout(() => {
      // Hide loader
      btnLoader.style.display = 'none';
      btnText.style.display = 'block';
      generateBtn.disabled = false;
      generateBtn.style.cursor = 'pointer';
      
      // Create and fade in image using the specific URL for this meme
      const img = document.createElement('img');
      img.src = MEME_IMAGES[memeId]; // Use the unique image URL for this meme
      img.style.cssText = `
        width: 100%;
        height: 100%;
        object-fit: cover;
        opacity: 0;
        transition: opacity 0.5s ease-in-out;
      `;
      
      iconContainer.innerHTML = '';
      iconContainer.appendChild(img);
      
      // Trigger fade in
      setTimeout(() => {
        img.style.opacity = '1';
      }, 50);
      
      currentImage = img;
    }, 2500);
  });

  // Apply button
  modal.querySelector('#applyBtn').addEventListener('click', () => {
    const newTopText = topInput.value || topText;
    const newBottomText = bottomInput.value || bottomText;
    
    cardElement.querySelector('.meme-text-top').textContent = newTopText;
    cardElement.querySelector('.meme-text-bottom').textContent = newBottomText;
    
    // If image was generated, apply it to the card and set up fade-out timer
    if (currentImage) {
      const cardIconContainer = cardElement.querySelector('.meme-icon-container');
      const cardImg = document.createElement('img');
      cardImg.src = currentImage.src;
      cardImg.style.cssText = `
        width: 100%;
        height: 100%;
        object-fit: cover;
        opacity: 1;
        transition: opacity 0.5s ease-in-out;
      `;
      
      const originalCardIcon = cardIconContainer.innerHTML;
      cardIconContainer.innerHTML = '';
      cardIconContainer.appendChild(cardImg);
      
      // Fade out and restore icon after 5 seconds
      setTimeout(() => {
        cardImg.style.opacity = '0';
        setTimeout(() => {
          cardIconContainer.innerHTML = originalCardIcon;
        }, 500);
      }, 5000);
    }
    
    // Add animation
    cardElement.style.animation = 'pulse 0.5s ease-out';
    setTimeout(() => {
      cardElement.style.animation = '';
    }, 500);
    
    modal.remove();
  });

  // Close on background click
  modal.addEventListener('click', function(e) {
    if (e.target === modal) {
      modal.remove();
    }
  });

  // Close on ESC key
  const escapeHandler = function(e) {
    if (e.key === 'Escape') {
      modal.remove();
      document.removeEventListener('keydown', escapeHandler);
    }
  };
  document.addEventListener('keydown', escapeHandler);
}

const pages = [
  'pg1.html',
  'pg2.html',
  'pg3.html',
  'pg4.html'
];

// Get current page index
let currentIndex = pages.indexOf(window.location.pathname.split("/").pop());

// Track direction: 1 = forward, -1 = backward
let direction = 1;

document.addEventListener('keydown', (event) => {
    if (event.key === 'Enter') {  // Return key
        // Move to next page in the current direction
        currentIndex += direction;

        // Reverse direction if we hit the ends
        if (currentIndex >= pages.length) {
            currentIndex = pages.length - 2; // Step back
            direction = -1;
        } else if (currentIndex < 0) {
            currentIndex = 1; // Step forward
            direction = 1;
        }

        window.location.href = pages[currentIndex];
    }
});




  </script>
</body>
</html>

